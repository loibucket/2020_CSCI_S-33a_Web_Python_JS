{% extends "auctions/layout.html" %}

{% block body %}

<img class="big_img" src="{{listing.image_url}}" alt="{{listing.image_url}}"/>
<h2>{{listing.title}}</h2>

<h5>
    {% if listing.is_active %}
    --Active Listing--
    {%else%}
    --Inactive Listing--
    {%endif%}
</h5>

<h5>Current Bid: {{current_bid}}</h5>
<h5>Number of Bids: {{n_bids}}</h5>
<h5>High Bidder: {{high_bidder}}</h5>

{#comment: allow place bid only if logged in#}

{% if user.is_authenticated %}
<form action="{% url 'listing_details' %}" method="post">
    {% csrf_token %}
    <h5><input type="number" step = 0.01 min=0.01 max=100000 name="bid_amount" placeholder="Bid Amount" size="5" value="{{bid_amount}}">{{status_message|safe}}
    </h5>
    <input type="hidden" name="listing_id" value={{listing.id}}>
    <input class="btn btn-primary" type="submit" value="Place Bid">
</form>
{% else %}
<a class="btn btn-primary" href="{% url 'login' %}">Login in to place bid</a>
{% endif %}

<br><br>
<h2>Description:</h2>
<p>{{listing.description}}</p>

<li>seller: {{listing.seller}}</li>
<li>item number: {{listing.id}}</li>
<li>category: {{listing.category}}</li>
<br><br>

<h2>Bid History:</h2>

<table>
    <tr>
        <th>Time</th>
        <th>Bidder</th>
        <th>Bid Amount</th>
    </tr>
    {% for bid in all_bids %}
    <tr>
        <td>{{bid.bid_time}}</td>
        <td>{{bid.bidder}}</td>
        <td>{{bid.bid_amount}}</td>
    </tr>
    {% empty %}
    <tr>
        <th>no bids</th>
    </tr>
    {% endfor %}

</table>

{% endblock %}